---
# title: "fbref Scraper"
# author: "saintsnumbers"
output:
  github_document:
    fig_height: 3
# date: 2019-10-09
editor_options:
  chunk_output_type: inline
---

```{r setup,include=F}
knitr::opts_chunk$set(echo=F,message=F,warning=F)

library(tidyverse)
library(rvest)
library(readr)
library(understatr)
library(ggsoccer)
library(ggrepel)
library(ggthemes)

set.seed(9999)
theme_set(theme_bw())

source("./R/fbref-functions.R")
source("./R/fbref-import.R")
source("./R/fbref-themes.R")
```

```{r plots}
# EPLPlayerStats %>%
#   filter(Squad %in% c("Southampton","Chelsea")) %>%
#   filter(Minutes>400) %>%
#   mutate(xA90=(90*xA/Minutes)) %>%
#   arrange(desc(xA90)) %>%
#   head(12) %>%
#   ggplot() +
#   geom_bar(aes(x=reorder(Player,xA90),y=xA90),stat="identity") +
#   themesfc() +
#   coord_flip()

EPLPlayerStats %>%
  filter(Squad=="Southampton") %>%
  arrange(desc(Minutes)) %>%
  ggplot(aes(x=reorder(Player,Minutes),y=Minutes)) +
  geom_bar(stat="identity",fill=sfc,width=0.8,alpha=0.6) +
  geom_label(aes(label=Minutes),colour=sfc_light,size=3) +
  themesfc() +
  labs(title="League minutes",
       x=element_blank(),
       y=element_blank()) +
  # scale_y_continuous(breaks=seq(0,1080,90)) +
  coord_flip()
ggsave("./plots/fbref/minutes.jpg")
```