Understat Scraper
================
saintsnumbers
2019-08-16

## [Understatr](https://github.com/ewenme/understatr)

### List of methods

    ##  [1] "get_league_seasons"       "get_league_teams_stats"  
    ##  [3] "get_leagues_meta"         "get_match_shots"         
    ##  [5] "get_match_stats"          "get_player_matches_stats"
    ##  [7] "get_player_seasons_stats" "get_player_shots"        
    ##  [9] "get_team_meta"            "get_team_players_stats"

### League methods

``` r
get_leagues_meta() %>% glimpse
```

    ## Observations: 36
    ## Variables: 4
    ## $ league_name <chr> "EPL", "EPL", "EPL", "EPL", "EPL", "EPL", "La liga...
    ## $ year        <dbl> 2019, 2018, 2017, 2016, 2015, 2014, 2019, 2018, 20...
    ## $ season      <chr> "2019/2020", "2018/2019", "2017/2018", "2016/2017"...
    ## $ url         <chr> "https://understat.com/league/EPL/2019", "https://...

``` r
get_league_seasons("EPL") %>% glimpse
```

    ## Observations: 6
    ## Variables: 4
    ## $ league_name <chr> "EPL", "EPL", "EPL", "EPL", "EPL", "EPL"
    ## $ year        <dbl> 2019, 2018, 2017, 2016, 2015, 2014
    ## $ season      <chr> "2019/2020", "2018/2019", "2017/2018", "2016/2017"...
    ## $ url         <chr> "https://understat.com/league/EPL/2019", "https://...

``` r
get_league_teams_stats("EPL",2018) %>% glimpse
```

    ## Observations: 760
    ## Variables: 25
    ## $ h_a              <chr> "a", "h", "a", "h", "h", "a", "h", "a", "h", ...
    ## $ xG               <dbl> 0.715382, 2.020040, 0.543665, 0.616013, 1.267...
    ## $ xGA              <dbl> 0.891038, 1.774710, 2.588700, 0.660035, 1.524...
    ## $ npxG             <dbl> 0.715382, 2.020040, 0.543665, 0.616013, 1.267...
    ## $ npxGA            <dbl> 0.891038, 1.774710, 1.827530, 0.660035, 1.524...
    ## $ deep             <int> 2, 4, 4, 2, 5, 5, 7, 6, 10, 6, 10, 0, 5, 5, 5...
    ## $ deep_allowed     <int> 4, 7, 11, 1, 7, 15, 6, 2, 5, 5, 0, 7, 1, 8, 4...
    ## $ scored           <int> 2, 2, 2, 1, 1, 0, 3, 2, 2, 1, 3, 0, 1, 0, 1, ...
    ## $ missed           <int> 2, 1, 2, 1, 3, 2, 0, 1, 0, 2, 1, 0, 0, 1, 1, ...
    ## $ xpts             <dbl> 1.1704, 1.5640, 0.1846, 1.2222, 1.1214, 1.482...
    ## $ result           <chr> "d", "w", "d", "d", "l", "l", "w", "w", "w", ...
    ## $ date             <date> 2018-08-11, 2018-08-18, 2018-08-25, 2018-09-...
    ## $ wins             <int> 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, ...
    ## $ draws            <int> 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, ...
    ## $ loses            <int> 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, ...
    ## $ pts              <int> 1, 3, 1, 1, 0, 0, 3, 3, 3, 0, 3, 1, 3, 0, 1, ...
    ## $ npxGD            <dbl> -0.175656, 0.245330, -1.283865, -0.044022, -0...
    ## $ ppda.att         <int> 312, 137, 208, 179, 179, 309, 216, 263, 176, ...
    ## $ ppda.def         <int> 20, 27, 22, 21, 27, 18, 26, 20, 20, 25, 28, 2...
    ## $ ppda_allowed.att <int> 228, 216, 187, 271, 244, 151, 230, 212, 266, ...
    ## $ ppda_allowed.def <int> 9, 22, 20, 29, 22, 31, 23, 17, 30, 27, 26, 25...
    ## $ team_id          <chr> "72", "72", "72", "72", "72", "72", "72", "72...
    ## $ team_name        <chr> "Everton", "Everton", "Everton", "Everton", "...
    ## $ league_name      <chr> "EPL", "EPL", "EPL", "EPL", "EPL", "EPL", "EP...
    ## $ year             <dbl> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 201...

### Team methods

``` r
get_team_meta("Southampton") %>% glimpse
```

    ## Observations: 6
    ## Variables: 4
    ## $ team_name <chr> "Southampton", "Southampton", "Southampton", "Southa...
    ## $ year      <dbl> 2019, 2018, 2017, 2016, 2015, 2014
    ## $ season    <chr> "2019/2020", "2018/2019", "2017/2018", "2016/2017", ...
    ## $ url       <chr> "https://understat.com/team/Southampton/2019", "http...

``` r
get_team_players_stats("Southampton",2019) %>% glimpse
```

    ## Observations: 20
    ## Variables: 19
    ## $ player_id    <int> 7701, 111, 790, 986, 343, 835, 839, 842, 843, 845...
    ## $ player_name  <chr> "Moussa Djenepo", "Jannik Vestergaard", "Nathan R...
    ## $ games        <int> 3, 5, 3, 5, 5, 2, 2, 5, 5, 3, 2, 4, 1, 2, 5, 5, 1...
    ## $ time         <int> 120, 450, 270, 274, 374, 169, 27, 426, 450, 191, ...
    ## $ goals        <int> 2, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
    ## $ xG           <dbl> 0.49976517, 0.28877660, 1.07509252, 0.82869066, 0...
    ## $ assists      <int> 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 2, 0, 1, 0, 0, 0...
    ## $ xA           <dbl> 0.34152615, 0.68833435, 0.46686324, 0.29102787, 0...
    ## $ shots        <int> 4, 5, 7, 7, 5, 1, 0, 3, 4, 2, 1, 5, 0, 0, 0, 1, 0...
    ## $ key_passes   <int> 1, 3, 4, 5, 4, 0, 0, 3, 6, 0, 0, 5, 0, 1, 0, 1, 0...
    ## $ yellow_cards <int> 2, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0...
    ## $ red_cards    <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0...
    ## $ position     <chr> "M S", "D", "F M", "F M S", "M S", "M", "S", "M",...
    ## $ team_name    <chr> "Southampton", "Southampton", "Southampton", "Sou...
    ## $ npg          <int> 2, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
    ## $ npxG         <dbl> 0.49976517, 0.28877660, 1.07509252, 0.82869066, 0...
    ## $ xGChain      <dbl> 1.7575870, 1.8352339, 1.7831537, 1.0088101, 1.697...
    ## $ xGBuildup    <dbl> 0.91629571, 1.83523393, 0.57948220, 0.04200481, 1...
    ## $ year         <int> 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2...

### Player methods

``` r
get_player_matches_stats(1734) %>% glimpse
```

    ## Observations: 132
    ## Variables: 22
    ## $ player_name <chr> "Sofiane Boufal", "Sofiane Boufal", "Sofiane Boufa...
    ## $ player_id   <int> 1734, 1734, 1734, 1734, 1734, 1734, 1734, 1734, 17...
    ## $ year        <int> 2019, 2019, 2019, 2019, 2018, 2018, 2018, 2018, 20...
    ## $ goals       <int> 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,...
    ## $ shots       <int> 2, 3, 0, 0, 0, 0, 2, 2, 2, 4, 0, 2, 1, 2, 0, 0, 0,...
    ## $ xG          <dbl> 0.36766055, 0.13260537, 0.00000000, 0.00000000, 0....
    ## $ time        <int> 86, 73, 7, 14, 26, 26, 71, 71, 81, 86, 82, 90, 72,...
    ## $ position    <chr> "AMC", "AMC", "Sub", "Sub", "Sub", "Sub", "ML", "M...
    ## $ h_team      <chr> "Sheffield United", "Southampton", "Brighton", "Bu...
    ## $ a_team      <chr> "Southampton", "Manchester United", "Southampton",...
    ## $ h_goals     <int> 0, 1, 0, 3, 2, 3, 2, 0, 2, 2, 3, 3, 3, 2, 0, 1, 0,...
    ## $ a_goals     <int> 1, 1, 2, 0, 2, 1, 0, 0, 1, 0, 1, 3, 2, 0, 1, 0, 0,...
    ## $ date        <date> 2019-09-14, 2019-08-31, 2019-08-24, 2019-08-10, 2...
    ## $ match_id    <int> 11686, 11673, 11666, 11646, 10335, 10317, 10309, 1...
    ## $ roster_id   <int> 349086, 347210, 344062, 341260, 333797, 332588, 33...
    ## $ xA          <dbl> 0.38049477, 0.45487234, 0.70704031, 0.05717216, 0....
    ## $ assists     <int> 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,...
    ## $ key_passes  <int> 2, 1, 1, 1, 1, 0, 3, 1, 1, 0, 1, 1, 4, 0, 1, 0, 1,...
    ## $ npg         <int> 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,...
    ## $ npxG        <dbl> 0.36766055, 0.13260537, 0.00000000, 0.00000000, 0....
    ## $ xGChain     <dbl> 1.40505767, 0.58440852, 0.70704031, 0.00000000, 0....
    ## $ xGBuildup   <dbl> 0.81338567, 0.47493526, 0.00000000, 0.00000000, 0....

``` r
get_player_seasons_stats(1734) %>% glimpse
```

    ## Observations: 6
    ## Variables: 19
    ## $ position    <chr> "Sub", "Sub", "Sub", "Sub", "AMC", "MC"
    ## $ games       <int> 4, 35, 26, 24, 29, 14
    ## $ goals       <int> 0, 3, 2, 1, 11, 3
    ## $ shots       <int> 5, 51, 30, 25, 50, 20
    ## $ time        <int> 180, 2114, 1198, 1090, 2351, 1013
    ## $ xG          <dbl> 0.5002659, 3.5110422, 1.6343503, 1.1150536, 4.8251...
    ## $ assists     <int> 2, 3, 2, 0, 4, 6
    ## $ xA          <dbl> 1.599580, 3.626196, 1.709456, 1.285913, 8.330865, ...
    ## $ key_passes  <int> 5, 40, 21, 23, 72, 28
    ## $ year        <int> 2019, 2018, 2017, 2016, 2015, 2014
    ## $ team_name   <chr> "Southampton", "Celta Vigo", "Southampton", "South...
    ## $ yellow      <int> 0, 6, 1, 5, 10, 1
    ## $ red         <int> 0, 0, 0, 0, 2, 0
    ## $ npg         <int> 0, 3, 2, 1, 9, 1
    ## $ npxG        <dbl> 0.5002659, 3.5110422, 1.6343503, 1.1150536, 3.3049...
    ## $ xGChain     <dbl> 2.696507, 9.149214, 4.961685, 4.480480, 11.388839,...
    ## $ xGBuildup   <dbl> 1.288321, 3.410239, 2.196722, 2.598717, 4.476609, ...
    ## $ player_id   <int> 1734, 1734, 1734, 1734, 1734, 1734
    ## $ player_name <chr> "Sofiane Boufal", "Sofiane Boufal", "Sofiane Boufa...

``` r
get_player_shots(790) %>% glimpse
```

    ## Observations: 262
    ## Variables: 20
    ## $ id              <int> 51666, 51858, 51865, 51866, 56917, 56924, 5692...
    ## $ minute          <int> 68, 35, 56, 60, 17, 45, 45, 60, 23, 50, 46, 82...
    ## $ result          <chr> "Goal", "BlockedShot", "Goal", "BlockedShot", ...
    ## $ X               <dbl> 0.711, 0.771, 0.910, 0.859, 0.733, 0.775, 0.77...
    ## $ Y               <dbl> 0.443, 0.679, 0.357, 0.334, 0.417, 0.258, 0.48...
    ## $ xG              <dbl> 0.011716064, 0.056415129, 0.138893932, 0.08171...
    ## $ player          <chr> "Nathan Redmond", "Nathan Redmond", "Nathan Re...
    ## $ h_a             <chr> "h", "a", "a", "a", "h", "h", "h", "h", "a", "...
    ## $ player_id       <int> 790, 790, 790, 790, 790, 790, 790, 790, 790, 7...
    ## $ situation       <chr> "OpenPlay", "DirectFreekick", "OpenPlay", "Ope...
    ## $ year            <int> 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015...
    ## $ shotType        <chr> "RightFoot", "RightFoot", "RightFoot", "RightF...
    ## $ match_id        <int> 85, 93, 93, 93, 102, 102, 102, 102, 119, 126, ...
    ## $ h_team          <chr> "Norwich", "Sunderland", "Sunderland", "Sunder...
    ## $ a_team          <chr> "Crystal Palace", "Norwich", "Norwich", "Norwi...
    ## $ h_goals         <int> 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 2, 1, 1, 6, 6...
    ## $ a_goals         <int> 3, 3, 3, 3, 1, 1, 1, 1, 0, 1, 1, 2, 2, 2, 2, 2...
    ## $ date            <date> 2015-08-08, 2015-08-15, 2015-08-15, 2015-08-1...
    ## $ player_assisted <chr> "Wes Hoolahan", NA, "Wes Hoolahan", "Robbie Br...
    ## $ lastAction      <chr> "Pass", "Standard", "Throughball", "TakeOn", "...

### Match methods

``` r
get_match_stats(11658) %>% glimpse
```

    ## Observations: 28
    ## Variables: 22
    ## $ id            <int> 341785, 341786, 341787, 341788, 341789, 341790, ...
    ## $ goals         <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, ...
    ## $ own_goals     <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ shots         <int> 0, 0, 2, 0, 1, 0, 0, 0, 3, 2, 2, 4, 0, 0, 0, 0, ...
    ## $ xG            <dbl> 0.00000000, 0.00000000, 0.74451357, 0.00000000, ...
    ## $ time          <int> 90, 90, 90, 90, 90, 79, 66, 90, 90, 70, 90, 24, ...
    ## $ player_id     <int> 5544, 111, 845, 6042, 7280, 835, 842, 843, 343, ...
    ## $ team_id       <int> 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, ...
    ## $ position      <chr> "GK", "DC", "DC", "DC", "DMR", "DML", "MC", "MC"...
    ## $ player        <chr> "Angus Gunn", "Jannik Vestergaard", "Maya Yoshid...
    ## $ h_a           <chr> "h", "h", "h", "h", "h", "h", "h", "h", "h", "h"...
    ## $ yellow_card   <int> 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, ...
    ## $ red_card      <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ roster_in     <int> 0, 0, 0, 0, 0, 341796, 341797, 0, 0, 341798, 0, ...
    ## $ roster_out    <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 341792, 341795,...
    ## $ key_passes    <int> 0, 1, 0, 0, 1, 0, 1, 2, 0, 1, 2, 0, 0, 0, 0, 2, ...
    ## $ assists       <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ xA            <dbl> 0.00000000, 0.08488458, 0.00000000, 0.00000000, ...
    ## $ xGChain       <dbl> 0.0000000, 0.6485187, 0.0000000, 0.5636341, 0.95...
    ## $ xGBuildup     <dbl> 0.00000000, 0.64851868, 0.00000000, 0.56363410, ...
    ## $ positionOrder <int> 1, 3, 3, 3, 5, 6, 9, 9, 9, 15, 15, 17, 17, 17, 1...
    ## $ match_id      <int> 11658, 11658, 11658, 11658, 11658, 11658, 11658,...

``` r
get_match_shots(11658) %>% glimpse
```

    ## Observations: 29
    ## Variables: 20
    ## $ id              <int> 310441, 310442, 310443, 310444, 310446, 310448...
    ## $ minute          <int> 17, 17, 20, 28, 37, 47, 52, 52, 66, 72, 79, 82...
    ## $ result          <chr> "MissedShots", "MissedShots", "SavedShot", "Bl...
    ## $ X               <dbl> 0.899, 0.925, 0.955, 0.881, 0.905, 0.893, 0.75...
    ## $ Y               <dbl> 0.339, 0.519, 0.481, 0.533, 0.481, 0.555, 0.60...
    ## $ xG              <dbl> 0.049099632, 0.355209351, 0.389304221, 0.13340...
    ## $ player          <chr> "Che Adams", "Maya Yoshida", "Maya Yoshida", "...
    ## $ h_a             <chr> "h", "h", "h", "h", "h", "h", "h", "h", "h", "...
    ## $ player_id       <int> 7700, 845, 845, 7280, 7700, 790, 343, 343, 986...
    ## $ situation       <chr> "FromCorner", "FromCorner", "FromCorner", "Ope...
    ## $ season          <int> 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019...
    ## $ shotType        <chr> "LeftFoot", "LeftFoot", "Head", "LeftFoot", "H...
    ## $ match_id        <int> 11658, 11658, 11658, 11658, 11658, 11658, 1165...
    ## $ h_team          <chr> "Southampton", "Southampton", "Southampton", "...
    ## $ a_team          <chr> "Liverpool", "Liverpool", "Liverpool", "Liverp...
    ## $ h_goals         <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
    ## $ a_goals         <int> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2...
    ## $ date            <chr> "2019-08-17 15:00:00", "2019-08-17 15:00:00", ...
    ## $ player_assisted <chr> NA, "Che Adams", "James Ward-Prowse", NA, "Ori...
    ## $ lastAction      <chr> "None", "CornerAwarded", "Aerial", "TakeOn", "...
